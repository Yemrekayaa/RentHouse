@model ResultHouseWithFeaturesDto
@{
	ViewBag.name = Model.name;
	var houses = ViewBag.CalendarValues as List<RentHouse.Dto.ReservationDto.ResultReservationDto>;
	var features = Model.HouseFeatures;
	var images = Model.HouseImages;
	Layout = "~/Views/UILayout/Index.cshtml";
}

<style>
	div.slider .slick-dots{
		bottom:0;
	}

	div.slider .slick-dots {
		bottom: 0;
	}

	.slick-dots li.slick-active button:before 
	{
		color: #1089ff;
	}
</style>
<section class="ftco-section ftco-car-details">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-md-12">
				<div class="car-details">
					<div class="rounded slider ">
						@foreach(var item in images)
						{
							<div><img src="@item.ImageUrl"></div>

						}
					</div>
					
					<div class="text text-center">
						<h2>@Model.name</h2>
						<span class="subheading">@Model.locationName.ToUpper()</span>
						
					</div>
				</div>
			</div>
		</div>
		<div class=" mt-2 d-flex justify-content-around flex-wrap">
			<div class=" d-flex align-self-stretch justify-content-center ftco-animate mx-10">
				<div class="media block-6 services">
					<div class="media-body py-md-4">
						<div class="d-flex mb-3 align-items-center">
							<div class="icon d-flex align-items-center justify-content-center"><img src="~/images/icons/area.svg" alt="Icon" width="35" height="35" /></div>
							<div class="text">
								<h3 class="heading mb-0 pl-3">
									Alan
									<span>@Model.area m2</span>
								</h3>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class=" d-flex align-self-stretch justify-content-center  ftco-animate mx-10">
				<div class="media block-6 services">
					<div class="media-body py-md-4">
						<div class="d-flex mb-3 align-items-center">
							<div class="icon d-flex align-items-center justify-content-center"><img src="~/images/icons/room.svg" alt="Icon" width="45" height="45" /></div>
							<div class="text">
								<h3 class="heading mb-0 pl-3">
									Oda Sayısı
									<span>@Model.numberOfRooms</span>
								</h3>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class=" d-flex align-self-stretch justify-content-center ftco-animate mx-10">
				<div class="media block-6 services">
					<div class="media-body py-md-4">
						<div class="d-flex mb-3 align-items-center">
							<div class="icon d-flex align-items-center justify-content-center"><img src="~/images/icons/bed.svg" alt="Icon" width="40" height="40" /></div>
							<div class="text">
								<h3 class="heading mb-0 pl-3">
									Yatak Sayısı
									<span>@Model.numberOfBeds</span>
								</h3>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>

		<div class="row">
			<div class="col-md-12 pills" style="margin-top:0rem;>
				<div class="bd-example bd-example-tabs">
					<div class="d-flex justify-content-center">
						<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">

							<li class="nav-item">
								<a class="nav-link active" id="pills-description-tab" data-toggle="pill" href="#pills-description" role="tab" aria-controls="pills-description" aria-expanded="true">Özellikler</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" id="pills-manufacturer-tab" data-toggle="pill" href="#pills-manufacturer" role="tab" aria-controls="pills-manufacturer" aria-expanded="true">Açıklama</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" id="pills-location-tab" data-toggle="pill" href="#pills-location" role="tab" aria-controls="pills-location" aria-expanded="true">Konum</a>
							</li>
						</ul>
					</div>

					<div class="tab-content" id="pills-tabContent">
						<div class="tab-pane fade show active" id="pills-description" role="tabpanel" aria-labelledby="pills-description-tab">	
							<ul class="features d-flex flex-wrap">
							@foreach (var item in features)
							{
								<div class="col-md-4 mb-2">
									<li class="@(item.Available ? "check" : "remove")"><span class="@(item.Available ? "ion-ios-checkmark": "ion-ios-close")"></span>@item.FeatureName</li>
								</div>
							}
							
								
							</ul>
	
						</div>

						<div class="tab-pane fade" id="pills-manufacturer" role="tabpanel" aria-labelledby="pills-manufacturer-tab">
							<p>Even the all-powerful Pointing has no control about the blind texts it is an almost unorthographic life One day however a small line of blind text by the name of Lorem Ipsum decided to leave for the far World of Grammar.</p>
							<p>When she reached the first hills of the Italic Mountains, she had a last view back on the skyline of her hometown Bookmarksgrove, the headline of Alphabet Village and the subline of her own road, the Line Lane. Pityful a rethoric question ran over her cheek, then she continued her way.</p>
						</div>
						
						<div class="tab-pane fade" id="pills-location" role="tabpanel" aria-labelledby="pills-location-tab">
							

								<div id="map" style="width: 100%; z-index: 1;"></div>
							
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="row" style="padding-top:2rem;">
			<div class="col-md" >
				<div class="container border-bottom pb-2">
					<h4 class="card-title mb-0 text-center " style="color: #1089ff; font-size:18px; font-weight:400px;">Rezervasyon Takvimi</h4>
					<p class="text text-center fw-light" style="line-height: 1.2; font-size:12px;">Gri renkle gösterilen günler, rezerve edilmiş günlerdir.</p>
				</div>

				<div class="calendar-section " style="padding: 2em;">
					<div class="row no-gutters">
						<div class="col-md">
							<div class="calendar calendar-first border rounded" id="calendar_first">
								<div class="calendar_header">
									<button class="switch-month switch-left">
										<i class="fa fa-chevron-left"></i>
									</button>
									<h2></h2>
									<button class="switch-month switch-right">
										<i class="fa fa-chevron-right"></i>
									</button>
								</div>
								<div class="calendar_weekdays"></div>
								<div class="calendar_content"></div>
							</div>
						</div>

					</div>
					<!-- End Calendar -->
				</div>
			</div>
		</div>
	</div>
</section>
<script>

	$(document).ready(function () {
		var calendarValues = @Html.Raw(Json.Serialize(houses));
		calendarValues.forEach(function (item) {
			var startDate = new Date(item.startDate);
			var endDate = new Date(item.endDate);
					selectDateRange(startDate, endDate);	
		});
		var longitude = '@Model.Longitude'.replace(',', '.');;
		var latiude = '@Model.Latitude'.replace(',', '.');;
		
		// Map Settings
		var homeIcon = L.icon({
			iconUrl: '/images/home-marker.png',

			iconSize: [64, 64], 
			shadowSize: [64, 64], 
			iconAnchor: [32, 64], 
			shadowAnchor: [32, 64],  
			popupAnchor: [0, -60] 
		});

		var map = L.map('map', {
			doubleClickZoom: false,
			
		}).setView([latiude, longitude], 12); 

		$('#pills-location-tab').on('shown.bs.tab', function (e) {
			map.invalidateSize();
			marker.closePopup();
			marker.openPopup();
		});
		
		
		L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
			attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
			maxZoom: 19
		}).addTo(map);
		

		var marker = L.marker([latiude, longitude], { icon: homeIcon }).addTo(map);
		var googleMapsLink = "http://maps.apple.com/?q=" + latiude + "," + longitude;
		marker.bindPopup(`
				<div class="text-center">
					<b class="d-block">@Model.name</b>
					<a href="${googleMapsLink}" target="_blank">Haritada Göster</a>
				</div>
				`, {
					closeButton: false
				}).openPopup();

		marker.on('popupopen', function () {
			var popupElement = document.querySelector('.leaflet-popup-content-wrapper');
			if (popupElement) {
				popupElement.style.cursor = 'pointer'; 
				popupElement.onclick = function () {
					window.open(googleMapsLink, '_blank'); 
				};
			}
		});

		$('.slider').slick({
			autoplay: true,
			dots: true,
			arrows: true,
			pauseOnHover: true,
			pauseOnDotsHover: true
		});
			

		
	});

	

</script>